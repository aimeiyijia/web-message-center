!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.WebMessageCenter=t():e.WebMessageCenter=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(3),t),i(r(4),t),i(r(5),t),i(r(6),t),i(r(7),t),i(r(8),t),i(r(9),t),i(r(10),t),i(r(11),t),i(r(12),t),i(r(13),t),i(r(15),t),i(r(16),t),i(r(17),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebMessageCenter=void 0;var n=r(0),i="undefined"!=typeof window&&window.Promise,o=function(){function e(e){void 0===e&&(e={}),this.origin=e.origin||"*",this.channel=e.channel||"",this.verifyDomain=e.verifyDomain,this.targetFrames=e.targetFrames||[],this.limitBroadcastToFramesArray=Boolean(e.targetFrames),this.isDestroyed=!1,this.listeners=[],this.hasAdditionalChecksForOnListeners=Boolean(this.verifyDomain||this.limitBroadcastToFramesArray)}return e.setPromise=function(t){e.Promise=t},e.target=function(t){return new e(t)},e.prototype.addTargetFrame=function(e){this.limitBroadcastToFramesArray&&this.targetFrames.push(e)},e.prototype.include=function(e){return null!=e&&(null!=e.Window&&(e.constructor===e.Window&&(n.childWindows.push(e),!0)))},e.prototype.target=function(t){return e.target(t)},e.prototype.emit=function(e,t,r){if(this.isDestroyed)return!1;var i=this.origin;if(e=this.namespaceEvent(e),n.isntString(e))return!1;if(n.isntString(i))return!1;"function"==typeof t&&(r=t,t=void 0);var o=n.packagePayload(e,i,t,r);return!!o&&(this.limitBroadcastToFramesArray?this.targetFramesAsWindows().forEach((function(e){n.sendMessage(e,o,i)})):n.broadcast(o,{origin:i,frame:window.top||window.self}),!0)},e.prototype.emitAsPromise=function(t,r){var n=this;return new e.Promise((function(e,i){n.emit(t,r,(function(t){e(t)}))||i(new Error('Listener not added for "'+t+'"'))}))},e.prototype.on=function(e,t){if(this.isDestroyed)return!1;var r=this,i=this.origin,o=t;return e=this.namespaceEvent(e),!n.subscriptionArgsInvalid(e,o,i)&&(this.hasAdditionalChecksForOnListeners&&(o=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];r.passesVerifyDomainCheck(this&&this.origin)&&r.hasMatchingTargetFrame(this&&this.source)&&t.apply(void 0,e)}),this.listeners.push({eventName:e,handler:o,originalHandler:t}),n.subscribers[i]=n.subscribers[i]||{},n.subscribers[i][e]=n.subscribers[i][e]||[],n.subscribers[i][e].push(o),!0)},e.prototype.off=function(e,t){var r=t;if(this.isDestroyed)return!1;if(this.verifyDomain)for(var i=0;i<this.listeners.length;i++){var o=this.listeners[i];o.originalHandler===t&&(r=o.handler)}e=this.namespaceEvent(e);var s=this.origin;if(n.subscriptionArgsInvalid(e,r,s))return!1;var a=n.subscribers[s]&&n.subscribers[s][e];if(!a)return!1;for(i=0;i<a.length;i++)if(a[i]===r)return a.splice(i,1),!0;return!1},e.prototype.teardown=function(){if(!this.isDestroyed){this.isDestroyed=!0;for(var e=0;e<this.listeners.length;e++){var t=this.listeners[e];this.off(t.eventName,t.handler)}this.listeners.length=0}},e.prototype.passesVerifyDomainCheck=function(e){return!this.verifyDomain||this.checkOrigin(e)},e.prototype.targetFramesAsWindows=function(){return this.limitBroadcastToFramesArray?this.targetFrames.map((function(e){return e instanceof HTMLIFrameElement?e.contentWindow:e})).filter((function(e){return e})):[]},e.prototype.hasMatchingTargetFrame=function(e){if(!this.limitBroadcastToFramesArray)return!0;var t=this.targetFramesAsWindows().find((function(t){return t===e}));return Boolean(t)},e.prototype.checkOrigin=function(e){var t,r=document.createElement("a");return r.href=location.href,t="https:"===r.protocol?r.host.replace(/:443$/,""):"http:"===r.protocol?r.host.replace(/:80$/,""):r.host,r.protocol+"//"+t===e||(!this.verifyDomain||this.verifyDomain(e))},e.prototype.namespaceEvent=function(e){return this.channel?this.channel+":"+e:e},e.Promise=i,e}();t.WebMessageCenter=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1);n.attach(),t.default=i.WebMessageCenter},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detach=t.attach=void 0;var n=r(0),i=!1;t.attach=function(){i||"undefined"==typeof window||(i=!0,window.addEventListener("message",n.onMessage,!1))},t.detach=function(){i=!1,window.removeEventListener("message",n.onMessage,!1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.broadcastToChildWindows=void 0;var n=r(0);t.broadcastToChildWindows=function(e,t,r){for(var i=n.childWindows.length-1;i>=0;i--){var o=n.childWindows[i];o.closed?n.childWindows.splice(i,1):r!==o&&n.broadcast(e,{origin:t,frame:o.top})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.broadcast=void 0;var n=r(0);t.broadcast=function e(t,r){var i,o=0,s=r.origin,a=r.frame;try{for(a.postMessage(t,s),n.hasOpener(a)&&a.opener.top!==window.top&&e(t,{origin:s,frame:a.opener.top});i=a.frames[o];)e(t,{origin:s,frame:i}),o++}catch(e){}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subscribers=t.childWindows=t.prefix=void 0,t.prefix="/*framebus*/",t.childWindows=[],t.subscribers={}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dispatch=void 0;var n=r(0);t.dispatch=function(e,t,r,i,o){if(n.subscribers[e]&&n.subscribers[e][t]){var s=[];r&&s.push(r),i&&s.push(i);for(var a=0;a<n.subscribers[e][t].length;a++)n.subscribers[e][t][a].apply(o,s)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasOpener=void 0,t.hasOpener=function(e){return e.top===e&&(null!=e.opener&&(e.opener!==e&&!0!==e.opener.closed))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isntString=void 0,t.isntString=function(e){return"string"!=typeof e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onMessage=void 0;var n=r(0);t.onMessage=function(e){if(!n.isntString(e.data)){var t=n.unpackPayload(e);if(t){var r=t.eventData,i=t.reply;n.dispatch("*",t.event,r,i,e),n.dispatch(e.origin,t.event,r,i,e),n.broadcastToChildWindows(e.data,t.origin,e.source)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.packagePayload=void 0;var n=r(0);t.packagePayload=function(e,t,r,i){var o,s={event:e,origin:t};"function"==typeof i&&(s.reply=n.subscribeReplier(i,t)),s.eventData=r;try{o=n.prefix+JSON.stringify(s)}catch(e){throw new Error("Could not stringify event: "+e.message)}return o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendMessage=void 0,t.sendMessage=function(e,t,r){try{e.postMessage(t,r)}catch(e){}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeReplier=void 0;var n=r(1),i=r(14);t.subscribeReplier=function(e,t){var r=i.generateUUID();return n.WebMessageCenter.target({origin:t}).on(r,(function i(o,s){e(o,s),n.WebMessageCenter.target({origin:t}).off(r,i)})),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUUID=void 0,t.generateUUID=function(){var e=(new Date).getTime(),t="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(r){var n=16*Math.random();return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(t+n)%16|0,t=Math.floor(t/16)),("x"===r?n:3&n|8).toString(16)}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subscriptionArgsInvalid=void 0;var n=r(0);t.subscriptionArgsInvalid=function(e,t,r){return!!n.isntString(e)||("function"!=typeof t||n.isntString(r))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unpackPayload=void 0;var n=r(0);t.unpackPayload=function(e){var t;if(e.data.slice(0,n.prefix.length)!==n.prefix)return!1;try{t=JSON.parse(e.data.slice(n.prefix.length))}catch(e){return!1}if(t.reply){var r=e.origin,i=e.source,o=t.reply;t.reply=function(e){if(i){var t=n.packagePayload(o,r,e);t&&i.postMessage(t,r)}}}return t}}]).default}));